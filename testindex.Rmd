---
title: "Musicology-Portfolio"
author: "Finn Duijvestijn"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    self_contained: false
    theme:
      version: 5

---

```{r}
library(tidyverse)
library(spotifyr)
library(flexdashboard)
library(ggplot2)
library(plotly)
library(compmus)

library(cowplot)
library(patchwork)

Sys.setenv(SPOTIFY_CLIENT_ID="34c9d0d698064bf886a78b343db5445b")
Sys.setenv(SPOTIFY_CLIENT_SECRET="d0e93595f1ee411bb21938c5cb50d247")

access_token <- get_spotify_access_token()

pop <- get_playlist_audio_features("", "2AipD5zTjWWM13wk2hZmej")
phonk <- get_playlist_audio_features("", "37i9dQZF1DWWY64wDtewQt")
rap <- get_playlist_audio_features("", "37i9dQZF1DX76t638V6CA8")

awards <-
  bind_rows(
    pop |> mutate(category = "Pop"),
    phonk |> mutate(category = "Phonk"),
    rap |> mutate(category = "Rap")
    
  )
```

Introduction {.storyboard data-icon="ion-ios-home"}
=========================================

### Exploring the Unique Sounds: A Comparison of Three Distinct Music Genres
<font style="font-size: 30px">My Corpus choice</font>

My corpus consists of a collection of songs from various genres including mainly Pop, Rap, and Phonk (which is a sub

***



Visual analysis of my corpus {.storyboard data-icon="fa-signal"}
=========================================

### tempos

```{r}

fr <- pop |> slice(1:35) |>
  add_audio_analysis()

qu <- phonk |> slice(1:35) |>
  add_audio_analysis()

qu2 <- rap |> slice(1:35) |>
  add_audio_analysis()

comp <-
  fr |>
  mutate(category = "Pop") |>
  bind_rows(qu |> mutate(category = "Phonk"), qu2 |> mutate(category = "Rap"))
comp <- comp %>% rename(track = track.name)
Tempo <- comp |>
  mutate(
    sections =
      map(
        sections,                                    # sections or segments
        summarise_at,
        vars(tempo, loudness, duration),             # features of interest
        list(section_mean = mean, section_sd = sd)   # aggregation functions
      )
  ) |>
  unnest(sections)

TempoAnimated <- Tempo %>%
  plot_ly(x = ~tempo, y = ~tempo_section_sd, color = ~tempo, size = ~loudness 
    ,hoverinfo = "text", text = paste("Track: ", Tempo$track, "<br>",
                          "Genre: ", Tempo$category, "<br>",
    #                       "Release date: ", Tempo$track.album.release_date, "<br>",
                          "Tempo: ", Tempo$tempo, "<br>",
                          "Loudness: ", Tempo$loudness, "<br>")
                          # "Time signature: ", Tempo$time_signature)
  ) %>%
  add_markers(frame = ~category) %>%
  layout(title = 'Tempo for Each Artist', xaxis = list(title = "Mean Tempo (bpm)"), yaxis = list(range = c(0,10), title = 'SD Tempo')) %>%
  animation_opts(frame = 2000, 
                 transition = 100,
                 easing = "linear") %>%
  animation_slider(currentvalue = list(prefix = NULL,
                                       font = list(color = "a9dea9", size = 20)))

TempoAnimated
```
***
**Explanation**  
Here you can see the mean tempo, the deviation of each song from that mean tempo, the loudness in size
and the bpm in the color of the point. The biggest deviation can be found in the Rap category as there are some outliers at the top of the plot.



Chroma features {.storyboard data-icon="ion-music-note"}
=========================================

### Chromas


***

Chroma can be a




What did I find {.storyboard data-icon="fa-spotify"}
=========================================

### Conclusion


### Discussion

