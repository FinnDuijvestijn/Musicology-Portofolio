---
title: "Musicology-Portfolio"
author: "Finn Duijvestijn"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    self_contained: false
    theme:
      version: 5

---

```{r}
library(tidyverse)
library(spotifyr)
library(flexdashboard)
library(ggplot2)
library(plotly)
library(compmus)

library(grid)
library(gridExtra)
library(cowplot)
library(patchwork)

Sys.setenv(SPOTIFY_CLIENT_ID="34c9d0d698064bf886a78b343db5445b")
Sys.setenv(SPOTIFY_CLIENT_SECRET="d0e93595f1ee411bb21938c5cb50d247")

access_token <- get_spotify_access_token()

pop <- get_playlist_audio_features("", "2AipD5zTjWWM13wk2hZmej")
phonk <- get_playlist_audio_features("", "37i9dQZF1DWWY64wDtewQt")
rap <- get_playlist_audio_features("", "37i9dQZF1DX76t638V6CA8")

awards <-
  bind_rows(
    pop |> mutate(category = "Pop"),
    phonk |> mutate(category = "Phonk"),
    rap |> mutate(category = "Rap")
    
  )
```

Introduction {.storyboard data-icon="ion-ios-home"}
=========================================

### Exploring the Unique Sounds: A Comparison of Three Distinct Music Genres 
<font style="font-size: 30px">My Corpus choice</font>

My corpus consists of a collection of songs from various genres including mainly Pop, Rap, and Phonk (which is a sub

***



Visual analysis of my corpus {.storyboard data-icon="fa-signal"}
=========================================

### Two **Mozart** chordograms: *Piano Sonata No. 11* and *MOZART PHONK*


***
**Explanation**
In the Phonk playlist there is the song: [MOZART PHONK](https://open.spotify.com/track/4uA4FfwW15P8PguZ1uOlpl?si=a6f5ace5b3984bf8), from which the chordogram can be seen in the top plot. I thought It would be fun to compare the chordogram of that song with the actual song from mozart: [Piano Sonata No. 11](https://open.spotify.com/track/16walLqBosZ5bHmKNGMHts?si=9cd8a36311e949ac), which can be seen in the plot below.


Chroma features {.storyboard data-icon="ion-music-note"}
=========================================

### Self-similarity matrices

```{r self sim, echo=FALSE}
norms_chroma <- list("euclidean", "manhattan", "chebyshev")
dists_chroma <- list("manhattan", "aitchison", "cosine", "angular")
summary_chroma <- list("mean", "aitchison_centre", "root_mean_square", "max", "acentre")

norms_timbre <- list("euclidean", "manhattan", "chebyshev")
dists_timbre <- list("euclidean", "cosine", "angular")
summary_timbre <- list("mean", "root_mean_square")

taste2 <-
  get_tidy_audio_analysis("2QjOHCTQ1Jl3zawyYOpxh6") |>
  compmus_align(bars, segments) |>
  select(bars) |>
  unnest(bars) |>
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = summary_chroma[5], norm = norms_chroma[3]
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = summary_timbre[1]
      )
  )
```

```{r self sim matrices, echo=FALSE}
self_sim <- bind_rows(
  taste2 |> 
    compmus_self_similarity(pitches, dists_chroma[1]) |> 
    mutate(d = d / max(d), type = "Chroma"),
  taste2 |> 
    compmus_self_similarity(timbre, dists_timbre[2]) |> 
    mutate(d = d / max(d), type = "Timbre")
) |>
  mutate() |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  facet_wrap(~type) +
  scale_fill_viridis_c(option = "mako", guide = "none") +
  theme_classic() + 
  labs(x = "", y = "", title = "'MOZART PHONK' vs 'Piano Sonata No.' 11")

subplot(self_sim, self_sim, self_sim, nrows=3)
```


***
**Explanation**  



### Keygram of __XXXTENTACION : SAD!__



***

In the Phonk playlist there is the song: 


What did I find {.storyboard data-icon="fa-spotify"}
=========================================

### Conclusion


### Discussion

